# ДЗ №8 — Анализ HTTP-трафика и XSS с использованием Scapy

## Цель работы
Изучить основы анализа HTTP-трафика с помощью библиотеки Scapy,
а также продемонстрировать эксплуатацию XSS-уязвимости на учебном
веб-приложении Google Gruyere.

---

## Используемые инструменты
- ОС: Ubuntu 20.04.6 LTS
- Python: 3.8.10
- Scapy
- Google Gruyere (http://google-gruyere.appspot.com)
- Веб-браузер Firefox

---

## Структура проекта

- `scapy_xss_analyzer.py` — скрипт для перехвата и анализа HTTP-трафика
- `normal.pcap` — перехваченный обычный HTTP-трафик
- `xss.pcap` — перехваченный трафик во время XSS-атаки
- `output_normal_analyze.txt` — вывод анализа обычного трафика
- `output_xss_analyze.txt` — вывод анализа трафика с XSS

---

## Этап 1. Настройка Scapy
Scapy был установлен и запущен с правами root.
Для корректного перехвата TCP-трафика временно отключалась отправка
RST-пакетов с помощью iptables.

---

## Этап 2. Перехват и анализ HTTP-трафика
С помощью Scapy был выполнен перехват HTTP-трафика сайта Google Gruyere.
В процессе взаимодействия с сайтом были зафиксированы HTTP-запросы
и ответы, включая методы GET и заголовки HTTP.

---

## Этап 3. Эксплуатация XSS
На сайте Google Gruyere была найдена точка внедрения reflected XSS
в GET-параметре запроса `snippet`.

В качестве полезной нагрузки использовался payload:

```html
<img src="nonexistent.jpg" onerror="alert('XSS')">
```
XSS-атака была успешно выполнена и подтверждена появлением
JavaScript alert в браузере.

---

## Этап 4. Анализ результатов
При анализе файла xxs.pcap было обнаружено:
- HTTP GET-запрос с XSS-полезной нагрузкой в параметре URL
- передача payload на уровне HTTP
- отражение вредоносного кода в HTTP-ответе сервера

По сравнению с обычным трафиком, HTTP-запрос и ответ во время XSS-атаки
содержат внедрённый JavaScript-код, что подтверждает наличие
reflected XSS-уязвимости.

---

## Вывод

В ходе работы был успешно перехвачен и проанализирован HTTP-трафик, 
а также продемонстрирована эксплуатация XSS-уязвимости.
Следы атаки были зафиксированы и подтверждены на уровне сетевого трафика.
